<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>向往的生活</title>
  
  <subtitle>干翻从前的自己</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.devopsai.cn/"/>
  <updated>2020-07-04T07:50:09.730Z</updated>
  <id>http://www.devopsai.cn/</id>
  
  <author>
    <name>骑驴的绅士</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>入门之部署二进制kubernetes</title>
    <link href="http://www.devopsai.cn/2020/07/04/%E5%85%A5%E9%97%A8%E4%B9%8B%E9%83%A8%E7%BD%B2%E4%BA%8C%E8%BF%9B%E5%88%B6kubernetes/"/>
    <id>http://www.devopsai.cn/2020/07/04/%E5%85%A5%E9%97%A8%E4%B9%8B%E9%83%A8%E7%BD%B2%E4%BA%8C%E8%BF%9B%E5%88%B6kubernetes/</id>
    <published>2020-07-04T07:44:29.226Z</published>
    <updated>2020-07-04T07:50:09.730Z</updated>
    
    <content type="html"><![CDATA[<h1 id="入门之部署二进制kubernetes"><a href="#入门之部署二进制kubernetes" class="headerlink" title="入门之部署二进制kubernetes"></a><em>入门之部署二进制kubernetes</em></h1><p><strong>一.部署前准备</strong>(centos7.x)</p><p>（三台都要做的）</p><p><strong><em>##关闭防火墙</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop firewalld &amp;&amp; systemctl disable firewalld #停止&amp;永久关闭防火墙</span><br></pre></td></tr></table></figure><p><strong><em>##关闭selinux</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#39;s&#x2F;enforcing&#x2F;disabled&#x2F;&#39; &#x2F;etc&#x2F;selinux&#x2F;config  #替换配置文件永久关闭</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0 #即可生效临时关闭命令</span><br></pre></td></tr></table></figure><p><strong><em>##关闭swap分区</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a #临时关闭swap</span><br><span class="line"></span><br><span class="line">sed -ri &#39;s&#x2F;.\*swap.\*&#x2F;#&amp;&#x2F;&#39; &#x2F;etc&#x2F;fstab #永久关闭</span><br></pre></td></tr></table></figure><p><strong><em>##设置主机名hosts配置文件</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl set-hostname &lt;yourname&gt;</span><br><span class="line"></span><br><span class="line">cat &gt;&gt; &#x2F;etc&#x2F;hosts &lt;&lt; EOF</span><br><span class="line"></span><br><span class="line">#&lt;your 1机ip&gt;    &lt;yourname&gt;</span><br><span class="line"></span><br><span class="line">192.168.159.9    k8s-master</span><br><span class="line"></span><br><span class="line">192.168.159.10    k8s-node1</span><br><span class="line"></span><br><span class="line">192.168.159.11    k8s-node2</span><br><span class="line"></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><strong><em>##设置内核参数</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat &gt;&#x2F;etc&#x2F;sysctl.d&#x2F;k8s.conf&lt;&lt; EOF</span><br><span class="line"></span><br><span class="line">net.bridge.bridge-nf-call-ip6tables &#x3D; 1  ##开启IPV4&#x2F;6的bridge的数据经过iptables处理</span><br><span class="line"></span><br><span class="line">net.bridge.bridge-nf-call-iptables &#x3D; 1</span><br><span class="line"></span><br><span class="line">net.ipv4.ip_forward &#x3D; 1    ##开启路由转发功能</span><br><span class="line"></span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">sysctl --system  #生效配置文件</span><br></pre></td></tr></table></figure><p><strong><em>##时间同步</em></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install ntpdate -y </span><br><span class="line"></span><br><span class="line">ntpdate time.windows.com</span><br></pre></td></tr></table></figure><p><strong>二.部署etcd集群</strong></p><p>etcd是k8s的数据库 是一个键值形式的存储系统 部署在三台k8s服务器上防止单点故障 如果资源足够</p><p>可以单独部署etcd（因为电脑内存有限直接部署在k8s-mater、node上了）</p><p>etcd1部署在master |etcd2部署在node1|etcd3部署在node2</p><p><strong><strong>此操作在k8s-master上，安装密钥生成工具cfssl</strong></strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget https:&#x2F;&#x2F;pkg.cfssl.org&#x2F;R1.2&#x2F;cfssl_linux-amd64</span><br><span class="line"></span><br><span class="line">wget https:&#x2F;&#x2F;pkg.cfssl.org&#x2F;R1.2&#x2F;cfssljson_linux-amd64</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;入门之部署二进制kubernetes&quot;&gt;&lt;a href=&quot;#入门之部署二进制kubernetes&quot; class=&quot;headerlink&quot; title=&quot;入门之部署二进制kubernetes&quot;&gt;&lt;/a&gt;&lt;em&gt;入门之部署二进制kubernetes&lt;/em&gt;&lt;/h1&gt;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>您好，Hi</title>
    <link href="http://www.devopsai.cn/2020/07/03/hello-hexo/"/>
    <id>http://www.devopsai.cn/2020/07/03/hello-hexo/</id>
    <published>2020-07-03T08:35:27.000Z</published>
    <updated>2020-07-03T09:10:55.392Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
      <category term="hexo" scheme="http://www.devopsai.cn/tags/hexo/"/>
    
  </entry>
  
</feed>
